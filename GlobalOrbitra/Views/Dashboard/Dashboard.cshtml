@model IEnumerable<GlobalOrbitra.Models.DTO.UserDto.WalletViewModel>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
<link href="~/css/dashboard.css" rel="stylesheet" />

@{
    var coinLogos = new Dictionary<string, string>(StringComparer.OrdinalIgnoreCase)
    {
        ["TRX"] = "https://cryptologos.cc/logos/tron-trx-logo.png",
        ["USDT"] = "https://cryptologos.cc/logos/tether-usdt-logo.png",
        ["BTC"] = "https://cryptologos.cc/logos/bitcoin-btc-logo.png",
        ["ETH"] = "https://cryptologos.cc/logos/ethereum-eth-logo.png"
    };

    string GetLogoUrl(string symbol)
    {
        // Boş veya null gelirse default
        if (string.IsNullOrWhiteSpace(symbol))
            return "https://cryptologos.cc/logos/default.svg";

        // Gereksiz parantezleri veya ekstra yazıları temizle
        var cleanSymbol = symbol.Split('(')[0].Trim().ToUpperInvariant();

        return coinLogos.ContainsKey(cleanSymbol) ? coinLogos[cleanSymbol] : "https://cryptologos.cc/logos/default.svg";
    }
}

<body class="page-assets">
    <div class="container">

        <!-- === ÜST KART === -->
        <div class="balance-card">
            <div class="balance-header">
                <h2>Estimated Balance</h2>
                <span class="pnl">Today's PnL: -$0.00 (0.00%)</span>
            </div>

            <div class="balance-value">
                @Model.Sum(w => w.Balance) TRX
            </div>
            <div class="balance-sub">
                ≈ $@Model.Sum(w => w.Balance * 0.30m) <!-- TEST İÇİN  -->
            </div>

            <div class="action-buttons">
                <button onclick="location.href='/WidthdrawDeposit/Deposit'">Deposit</button>
                <button onclick="location.href='/WidthdrawDeposit/Widthdraw'">Withdraw</button>
                <button onclick="location.href='/Dashboard/TransactionHistory'">History</button>
            </div>
        </div>

        <div class="assets-card">
            <div class="assets-header">
                <h2>My Assets</h2>
                <div class="search-bar">
                    <input type="text" placeholder="Search Coin..." />
                    <label class="hide-small-assets">
                        <input type="checkbox" /> Hide assets < $1
                    </label>
                </div>
            </div>

            <table>
                <thead>
                    <tr>
                        <th>Coin</th>
                        <th>Amount</th>
                        <th>Value (USD)</th>
                        <th>Coin Price</th>
                        <th>Today's PnL</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var w in Model)
                    {
                        <tr>
                            <td>
                                <div class="coin">
                                    <img src="@w.LogoUrl" alt="@w.TokenSymbol" style="width:24px;height:24px;"
                                         onerror="this.onerror=null;this.src='https://cryptologos.cc/logos/default.png';" />

                                    <div>
                                        <div class="coin-name">@w.TokenSymbol</div>
                                        <div class="coin-symbol">@w.TokenSymbol</div>
                                    </div>
                                </div>
                            </td>
                            <td>@w.Balance</td>
                            <td>$@(w.Balance * 0.30m)</td>
                            <td>$0.30</td>
                            <td class="positive">+0.00%</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</body>
