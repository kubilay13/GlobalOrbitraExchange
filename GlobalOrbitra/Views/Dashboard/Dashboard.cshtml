@model IEnumerable<GlobalOrbitra.Models.DTO.UserDto.WalletViewModel>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
<link href="~/css/dashboard.css" rel="stylesheet" />

@{
    string GetLogoPath(string symbol)
    {
        if (string.IsNullOrWhiteSpace(symbol))
            return Url.Content("~/images/default.svg");

        var cleanSymbol = symbol.Split('(')[0].Trim().ToLowerInvariant();
        return Url.Content($"~/images/{cleanSymbol}.svg");
    }
}

<body class="page-assets">
    <div class="container">

        <!-- === ÜST KART === -->
        <div class="balance-card">
            <div class="balance-header">
                <h2>Estimated Balance</h2>
                <span class="pnl">Today's PnL: -$0.00 (0.00%)</span>
            </div>

            <div class="balance-value">
                $@(Model.Sum(w => w.Balance).ToString("N2", System.Globalization.CultureInfo.InvariantCulture))
            </div>
            <div class="balance-sub">
                ≈ $@(Model.Sum(w => w.Balance * 0.30m).ToString("N2", System.Globalization.CultureInfo.InvariantCulture)) <!-- TEST için -->
            </div>

            <div class="action-buttons">
                <button onclick="location.href='/WidthdrawDeposit/Deposit'">Deposit</button>
                <button onclick="location.href='/WidthdrawDeposit/Withdraw'">Withdraw</button>
                <button onclick="location.href='/Dashboard/TransactionHistory'">History</button>
            </div>
        </div>

        <div class="assets-card">
            <div class="assets-header">
                <h2>My Assets</h2>
                <div class="search-bar">
                    <input type="text" placeholder="Search Coin..." />
                    <label class="hide-small-assets">
                        <input type="checkbox" /> Hide assets < $1
                    </label>
                </div>
            </div>

            <table>
                <thead>
                    <tr>
                        <th>Coin</th>
                        <th>Amount</th>
                        <th>Value (USD)</th>
                        <th>Coin Price</th>
                        <th>Today's PnL</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var w in Model)
                    {
                        <tr>
                            <td>
                                <div class="coin">
                                    <img src="@GetLogoPath(w.TokenSymbol)"
                                         alt="@w.TokenSymbol"
                                         style="width:24px;height:24px;"
                                         onerror="this.onerror=null;this.src='@Url.Content("~/img/coins/default.svg")';" />

                                    <div>
                                        <div class="coin-name">@w.TokenSymbol</div>
                                        <div class="coin-symbol">@w.TokenSymbol</div>
                                    </div>
                                </div>
                            </td>
                            <td>@w.Balance.ToString("N4", System.Globalization.CultureInfo.InvariantCulture)</td>
                            <td>$@(w.Balance.ToString("N2", System.Globalization.CultureInfo.InvariantCulture))</td>
                            <td>$0.30</td>
                            <td class="positive">+0.00%</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</body>
